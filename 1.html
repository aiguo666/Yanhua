<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>爱心生日烟花</title>
<style>
* {margin:0;padding:0;overflow:hidden;}
body {background:#000;}
#canvas {width:100vw;height:100vh;}
</style>
</head>
<body>
<canvas id="canvas"></canvas>
<script>
const c=document.getElementById("canvas"),ctx=c.getContext("2d");
function resize(){c.width=window.innerWidth;c.height=window.innerHeight;}
window.onresize=resize;resize();

// 爱心公式+烟花粒子
class Particle{
  constructor(x,y){
    this.x=x;this.y=y;this.r=random(2,4);
    this.color=`hsl(${random(0,360)},100%,60%)`;
    this.vx=random(-3,3);this.vy=random(-8,-3);
    this.ay=0.2;this.life=100;
  }
  update(){
    this.vy+=this.ay;this.x+=this.vx;this.y+=this.vy;this.life--;
  }
  draw(){
    ctx.beginPath();ctx.arc(this.x,this.y,this.r,0,2*Math.PI);
    ctx.fillStyle=this.color;ctx.fill();
  }
}

// 爱心绽放组
class HeartFire{
  constructor(x,y){
    this.x=x;this.y=y;this.particles=[];this.create();
  }
  create(){
    for(let i=0;i<120;i++){
      let t=random(0,2*Math.PI);
      let r=random(1,30);
      // 爱心参数方程，立体缩放
      let hx=this.x+(16*Math.sin(t)**3)*r*0.1;
      let hy=this.y-(13*Math.cos(t)-5*Math.cos(2*t)-2*Math.cos(3*t)-Math.cos(4*t))*r*0.1;
      this.particles.push(new Particle(hx,hy));
    }
  }
  update(){
    return this.particles.filter(p=>{p.update();return p.life>0;});
  }
  draw(){
    this.particles.forEach(p=>p.draw());
  }
}

let fires=[],timer=0;
function random(min,max){return Math.random()*(max-min)+min;}

// 循环渲染
function animate(){
  requestAnimationFrame(animate);
  ctx.fillStyle="rgba(0,0,0,0.1)";ctx.fillRect(0,0,c.width,c.height);
  
  // 定时生成爱心烟花
  timer++;
  if(timer%150===0){
    fires.push(new HeartFire(c.width/2,c.height/2));
    timer=0;
  }
  
  // 更新绘制烟花
  fires=fires.filter(fire=>{
    fire.particles=fire.update();
    fire.draw();
    return fire.particles.length>0;
  });
}
animate();
</script>
</body>
</html>